<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!doctype html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta charset="utf-8"&gt;&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</span></p>
<p class="p1"><span class="s1">&lt;title&gt;Interactive Itinerary — Japan + Hong Kong (UX Friendly)&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;link rel="preconnect" href="https://fonts.googleapis.com"&gt;</span></p>
<p class="p1"><span class="s1">&lt;link rel="preconnect" href="https://fonts.gstatic.com" crossorigin&gt;</span></p>
<p class="p1"><span class="s1">&lt;link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&amp;display=swap" rel="stylesheet"&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- Chosen Palette: Warm Neutrals --&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- Application Structure Plan: The SPA features a main content area for the itinerary and a sticky left sidebar for navigation (Table of Contents). Major sections (Pre-Trip, Cities, Practical Considerations) are clearly delineated with prominent headings. Each day within a city allows users to select from alternative 'paths' via tab-like buttons, dynamically revealing detailed content. Extensive textual information is presented in collapsible &lt;details&gt; sections to maintain a clean layout. This structure prioritizes easy navigation and discovery for the user. --&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- Visualization &amp; Content Choices: The core is a chronological timeline (HTML/CSS) with interactive daily paths. Goal: Organize/Compare. Method: Tabbed content for daily paths (HTML/CSS/JS). Interaction: Click buttons to switch paths, with visual feedback (active state, subtle border on content). Justification: Provides clear alternative choices without clutter. Goal: Inform/Organize. Method: Collapsible &lt;details&gt; sections for comprehensive textual content (HTML/CSS/JS). Interaction: Click to expand/collapse. Justification: Manages large information blocks, enhancing readability and user control. Goal: Inform/Feedback. Method: Custom modal dialogs (HTML/CSS/JS). Interaction: Replaces browser alerts/confirms for smoother user flow. Justification: Improved visual integration and less disruptive. --&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. --&gt;</span></p>
<p class="p1"><span class="s1">&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>:root { color-scheme: light dark; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>html.dark body { background: #0b1220; color: #e5e7eb; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>body { font-family: 'Inter', sans-serif; background-color: #F5F5F4; /* stone-100 */ color: #44403C; /* stone-700 */ }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.card { border:1px solid rgb(226,232,240); border-radius: 14px; background: white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .card { border-color: rgb(30,41,59); background: rgb(15,23,42); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.badge { border-radius: 9999px; padding: 2px 8px; font-size: 12px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.badge-black { background:#000; color:#fff; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.tab-btn { border:1px solid transparent; padding: 6px 10px; border-radius: 10px; transition: background-color 0.2s, color 0.2s; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.tab-btn.active { background: #A8A29E; /* stone-400 */ color: white; font-weight: 600; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .tab-btn.active { background: #57534E; /* stone-600 */ }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.progress { height: 8px; background: rgb(226,232,240); border-radius: 9999px; overflow: hidden; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .progress { background: rgb(30,41,59); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.progress &gt; span { display:block; height:100%; background: linear-gradient(90deg, #22c55e, #06b6d4); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.btn { border:1px solid rgb(203,213,225); border-radius: 10px; padding:6px 10px; transition: background-color 0.2s, color 0.2s, border-color 0.2s; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .btn { border-color: rgb(51,65,85); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.btn-primary { background: #57534E; /* stone-600 */ color:white; border-color:#57534E; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.btn-primary:hover { background: #44403C; /* stone-700 */ border-color:#44403C; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.btn-danger { background: #EF4444; /* red-500 */ color:white; border-color:#EF4444; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.btn-danger:hover { background: #DC2626; /* red-600 */ border-color:#DC2626; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.pill { border:1px solid rgb(203,213,225); border-radius:9999px; padding:2px 8px; font-size:12px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .pill { border-color: rgb(51,65,85); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.strike { text-decoration: line-through; opacity:.6; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>/* New UX styles */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.main-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>@media (min-width: 1024px) { /* lg breakpoint */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.main-grid { grid-template-columns: 200px 1fr; } /* Sidebar width + content */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>.content-area { padding-left: 1.5rem; } /* Offset for fixed sidebar */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.sidebar {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>position: sticky;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>top: 5rem; /* Below header */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>height: calc(100vh - 6rem); /* Adjust based on header height */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>overflow-y: auto;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-right: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>scrollbar-width: thin;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>scrollbar-color: #A8A29E #F5F5F4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.sidebar a {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>display: block;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding: 0.5rem 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-bottom: 0.25rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-radius: 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>color: #57534E; /* stone-600 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: background-color 0.2s, color 0.2s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.sidebar a:hover, .sidebar a.active {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>background-color: #E7E5E4; /* stone-200 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>color: #292524; /* stone-800 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .sidebar a { color: #A8A29E; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .sidebar a:hover, .dark .sidebar a.active { background-color: #3F3F46; /* neutral-700 */ color: #F5F5F4; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.section-heading {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>font-size: 2.25rem; /* text-4xl */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>font-weight: 900; /* font-black */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>color: #292524; /* stone-800 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-bottom: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-top: 1rem; /* Space for sticky header */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-bottom: 2px solid #D6D3D1; /* stone-300 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-bottom: 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-top: 3rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.path-details {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-left: 3px solid #D6D3D1; /* stone-300 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-left: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-top: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>text-align: left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>background-color: #F8F7F6; /* very light neutral */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-radius: 0.5rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding: 1rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: all 0.3s ease-in-out;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>opacity: 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .path-details {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>background-color: #1E293B; /* slate-800 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-color: #334155; /* slate-700 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.path-details.hidden {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>opacity: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>max-height: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>overflow: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding-bottom: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-top: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>margin-bottom: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>details summary {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>font-weight: 600;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding: 0.5rem 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>color: #57534E; /* stone-600 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: color 0.2s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>details summary:hover { color: #292524; /* stone-800 */ }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>details[open] summary { color: #292524; /* stone-800 */ }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>details &gt; div {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>overflow: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: max-height 0.3s ease-out;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>details:not([open]) &gt; div { max-height: 0; } /* Managed by JS for smooth transition */</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>/* Modal Styles */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.modal-overlay {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>position: fixed;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>top: 0; left: 0; right: 0; bottom: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>background-color: rgba(0,0,0,0.5);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>display: flex;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>justify-content: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>align-items: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>z-index: 1000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>opacity: 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>visibility: hidden;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: opacity 0.3s, visibility 0.3s;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.modal-overlay.open { opacity: 1; visibility: visible; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.modal-content {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>background-color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>padding: 2rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>border-radius: 0.75rem;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>max-width: 400px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>width: 90%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transform: translateY(-20px);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>transition: transform 0.3s ease-out;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.modal-overlay.open .modal-content { transform: translateY(0); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.dark .modal-content { background-color: #1A202C; /* dark bg */ color: #E2E8F0; }</span></p>
<p class="p1"><span class="s1">&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body class="min-h-screen"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-900/80 border-b border-slate-200 dark:border-slate-800"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;span class="text-xl font-bold text-stone-800 dark:text-stone-100"&gt;🗺️ Interactive Itinerary — Japan + Hong Kong&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="ml-auto flex items-center gap-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="printBtn" class="btn"&gt;🖨️ Print&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="exportBtn" class="btn"&gt;⬇️ Export&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label class="btn cursor-pointer"&gt;⬆️ Import</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;input id="importInput" type="file" accept="application/json" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="resetBtn" class="btn btn-danger"&gt;↺ Reset&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label class="flex items-center gap-2 pl-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;span&gt;🌞&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;input id="darkToggle" type="checkbox" class="accent-blue-500"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;span&gt;🌙&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="max-w-6xl mx-auto px-4 py-4 main-grid"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Sidebar / Table of Contents --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="hidden lg:block sidebar"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;nav id="sidebarNav"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h3 class="font-bold text-stone-800 text-lg mb-2"&gt;Sections&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;!-- Content populated by JS --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/nav&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Main Content Area --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="content-area lg:col-start-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="card p-4 mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="grid grid-cols-2 md:grid-cols-4 gap-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="text-xs mb-1 text-slate-500"&gt;City&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;select id="cityFilter" class="w-full rounded-xl border px-3 py-2 bg-white dark:bg-slate-900"&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="text-xs mb-1 text-slate-500"&gt;Tag&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;select id="tagFilter" class="w-full rounded-xl border px-3 py-2 bg-white dark:bg-slate-900"&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="text-xs mb-1 text-slate-500"&gt;Status&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;select id="statusFilter" class="w-full rounded-xl border px-3 py-2 bg-white dark:bg-slate-900"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;option&gt;All&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;option&gt;Todo&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;option&gt;Done&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="text-xs mb-1 text-slate-500"&gt;Search&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="relative"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;input id="searchInput" class="w-full rounded-xl border px-3 py-2" placeholder="Find activities…"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">              </span>&lt;div class="absolute right-2 top-2 text-slate-400"&gt;🔎&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="card p-4 mb-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="text-base font-semibold mb-2"&gt;Progress&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="progressSummary" class="space-y-2"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div id="nextUpWrap" class="max-w-6xl mx-auto px-0"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;!-- Content sections for itinerary and practical info --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div id="itineraryContent" class="pb-16"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div class="max-w-6xl mx-auto px-4 pb-16 text-xs text-slate-500 text-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Built with ❤️ — tick off what you’ve done, filter by city/tag, Export/Import to sync across devices. Print anytime.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;!-- Custom Modal HTML --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;div id="customModal" class="modal-overlay"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="modal-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;h3 id="modalTitle" class="text-lg font-bold mb-4"&gt;&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;p id="modalMessage" class="text-sm text-stone-600 dark:text-stone-300 mb-6"&gt;&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;div class="flex justify-end gap-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="modalCancel" class="btn"&gt;Cancel&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button id="modalConfirm" class="btn btn-primary"&gt;OK&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">const STORAGE_KEY = "itinerary-progress-v2-standalone";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const itineraryData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>preTripEssentials: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>id: "pre-trip",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>title: "Pre-Trip Essentials: Preparing for Your Seamless Expedition",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sections: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Navigating Japan: The Veins of the Nation", content: `Japan's public transportation system is globally acclaimed for its efficiency, punctuality, and extensive network, making travel across the country remarkably convenient. The Shinkansen (Bullet Train) is the quintessential mode of inter-city travel, connecting major hubs like Tokyo, Kyoto, and Osaka with unparalleled speed and comfort. For optimal planning, online reservation is highly recommended. Local train and subway systems are user-friendly, with color-coded lines. IC Cards (SUICA/ICOCA) are indispensable prepaid cards for cash-free travel and payments. Luggage delivery services like LUGGAGE EXPRESS are highly advantageous for groups traveling between cities, freeing you from carrying heavy bags.`, details: `&lt;p class="text-sm text-stone-500 mt-2"&gt;&lt;strong&gt;Shinkansen Tips:&lt;/strong&gt; Online reservation allows free changes. An additional "NOZOMI MIZUHO Ticket" is required for the fastest Nozomi trains. Evaluate JR Pass cost-effectiveness carefully.&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;Local Trains:&lt;/strong&gt; Avoid peak rush hours (8-9 AM, after 5 PM). Color-coded lines simplify navigation.&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;IC Cards:&lt;/strong&gt; SUICA for Tokyo (downloadable to Apple Wallet), ICOCA for Kansai (Kyoto, Osaka, Nara). Accepted for transport and payments at stores.&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;Luggage Delivery:&lt;/strong&gt; LUGGAGE EXPRESS can transport luggage from Tokyo to Kyoto hotel on the same day via Shinkansen, turning travel days into sightseeing opportunities.&lt;/p&gt;` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Navigating Hong Kong: Urban Efficiency", content: `Hong Kong's compact geography and advanced infrastructure ensure highly efficient urban transit. The MTR (Mass Transit Railway) is the backbone of its urban transport. The Octopus Card is an essential contactless smart card for all transport and payments. Double-decker buses offer great views, and taxis are reliable (cash only).`, details: `&lt;p class="text-sm text-stone-500 mt-2"&gt;&lt;strong&gt;MTR:&lt;/strong&gt; Provides quick and efficient connections across all major districts.&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;Octopus Card:&lt;/strong&gt; Available as physical Tourist Octopus or Mobile Octopus. Widely accepted for transport, dining, entertainment, and shopping.&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;Buses &amp; Taxis:&lt;/strong&gt; Double-decker buses offer elevated views. Taxis are metered and trustworthy (cash payments primarily).&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;HKeMobility:&lt;/strong&gt; Useful mobile application for planning journeys across all public transport modes.&lt;/p&gt;` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Connectivity &amp; Cash: Staying Connected and Prepared", content: `Reliable internet access is paramount. Consider portable Wi-Fi devices or local eSIMs. Both Japan and Hong Kong still operate significantly on cash, especially for smaller establishments. Carry sufficient Japanese Yen and Hong Kong Dollars.`, details: `` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Cultural Compass: Respectful Immersion", content: `Engaging respectfully with local customs enhances the travel experience. Observe train etiquette (avoid loud conversations, respect priority seating). Learning basic phrases in Japanese and Cantonese can enrich interactions.`, details: `&lt;p class="text-sm text-stone-500 mt-2"&gt;&lt;strong&gt;Japanese Phrases:&lt;/strong&gt; &lt;em&gt;arigato&lt;/em&gt; (thank you), &lt;em&gt;sumimasen&lt;/em&gt; (excuse me).&lt;/p&gt;&lt;p class="text-sm text-stone-500 mt-1"&gt;&lt;strong&gt;Cantonese Phrases:&lt;/strong&gt; &lt;em&gt;jo san&lt;/em&gt; (good morning), &lt;em&gt;m goi&lt;/em&gt; (thank you/excuse me).&lt;/p&gt;` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Autumn's Embrace: Weather, Festivals &amp; Public Holidays (September - October 2025)", content: `The travel period offers pleasant autumn weather but be mindful of potential typhoons in early September. This period is vibrant with festivals and public holidays, which can lead to increased domestic tourism and crowds. Proactive booking and flexible planning are essential.`, details: `&lt;div class="overflow-x-auto mt-4"&gt;&lt;table class="min-w-full bg-white border border-stone-300 rounded-lg"&gt;&lt;thead&gt;&lt;tr class="bg-stone-100 text-stone-700"&gt;&lt;th class="py-2 px-4 border-b text-left text-sm font-semibold"&gt;Date&lt;/th&gt;&lt;th class="py-2 px-4 border-b text-left text-sm font-semibold"&gt;Holiday/Festival Name&lt;/th&gt;&lt;th class="py-2 px-4 border-b text-left text-sm font-semibold"&gt;Location&lt;/th&gt;&lt;th class="py-2 px-4 border-b text-left text-sm font-semibold"&gt;Brief Description&lt;/th&gt;&lt;th class="py-2 px-4 border-b text-left text-sm font-semibold"&gt;Impact on Travel&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 13-14&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;ULTRA JAPAN&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Tokyo Odaiba Ultra Park&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Electronic music festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Potential for large crowds, especially youth&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 14-15&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kishiwada Danjiri Matsuri&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kishiwada City, Osaka&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Energetic festival with large wooden floats&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Expect significant local crowds in Kishiwada&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 15&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Respect for the Aged Day&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Day to respect elderly, celebrate long life&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday - Expect crowds at popular sites &amp; on transport&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 15-29&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Tokyo Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Ikebukuro, Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;International performing arts festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Cultural events, potential for localized crowds&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Mid-Sep&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Nezu-jinja Shrine Annual Grand Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Nezu Shrine, Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Lively affair with stalls, traditional dance&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Localized crowds, cultural experience&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 21&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Chofu Autumn Fireworks&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Banks of Tama River, Chofu, Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Music and fireworks display&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Large crowds along the river&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep 23&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Autumnal Equinox Day&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Day to honor and remember ancestors&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday - Expect crowds at popular sites &amp; on transport&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep-Oct&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Cosmos Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Showa Kinen Park, Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Fields of cosmos flowers in bloom&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Popular for flower viewing, expect visitors&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep-Oct&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Red Spider Lily Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kinchakuda, Saitama&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Five million blood-red flowers in bloom&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Popular for flower viewing, expect visitors&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sep-Nov&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;USJ Halloween&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Universal Studios Japan, Osaka&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Park transforms into Halloween party with themed food&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;High attendance, especially weekends&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 1&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Citizens Day&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Many Tokyo government facilities offer free admission&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Increased visitors to participating facilities&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Early Oct&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Fukuro Matsuri&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Ikebukuro, Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Mikoshi parade, music, dance performances&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Localized crowds, vibrant street atmosphere&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 13&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Sports Day&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Day to enjoy physical activity, focus on health&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;National Holiday - Expect crowds at popular sites &amp; on transport&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 13&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Bakeneko Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Tokyo&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Unique cat-themed festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Niche event, potential for quirky cultural experience&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 14&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kawagoe Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kawagoe, Saitama&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Traditional festival in "Little Edo"&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Localized crowds, cultural immersion&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 22&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Jidai Matsuri&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kyoto&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Historical parade&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Significant crowds along parade route&lt;/td&gt;&lt;/tr&gt;&lt;tr class="border-b border-stone-200"&gt;&lt;td class="py-2 px-4 text-sm"&gt;Oct 22&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kurama Fire Festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Kurama, Kyoto&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Traditional fire festival&lt;/td&gt;&lt;td class="py-2 px-4 text-sm"&gt;Significant localized crowds, unique experience&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;` }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>itineraryDays: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-09-27", "city": "Tokyo", "canon": "Canon: be in Tokyo", "paths": [{"id": "A", "name": "Shibuya/Harajuku + view", "slots": {"Morning": [{"id": "0927A-M1", "title": "Arrive &amp; drop bags", "tags": ["logistics"]}, {"id": "0927A-M2", "title": "Coffee at depachika", "tags": ["food", "market"]}], "Afternoon": [{"id": "0927A-P1", "title": "Meiji Jingu Shrine", "tags": ["shrine", "culture", "calm"]}, {"id": "0927A-P2", "title": "Harajuku (Takeshita)", "tags": ["shopping", "street"]}], "Evening": [{"id": "0927A-E1", "title": "Shibuya Sky sunset", "tags": ["view", "rooftop"]}, {"id": "0927A-E2", "title": "Cocktails @ The Roof SHIBUYA SKY", "tags": ["rooftop", "bar"]}]}}, {"id": "B", "name": "Asakusa + Skytree", "slots": {"Morning": [{"id": "0927B-M1", "title": "Senso-ji &amp; Nakamise", "tags": ["temple", "streetfood"]}], "Afternoon": [{"id": "0927B-P1", "title": "Tokyo Skytree", "tags": ["view"]}, {"id": "0927B-P2", "title": "Solamachi bites", "tags": ["food", "mall"]}], "Evening": [{"id": "0927B-E1", "title": "Omoide Yokocho yakitori", "tags": ["izakaya", "food"]}, {"id": "0927B-E2", "title": "Golden Gai microbars", "tags": ["nightlife"]}]}}, {"id": "C", "name": "Roppongi art + skyline bar", "slots": {"Morning": [{"id": "0927C-M1", "title": "Late brunch settle-in", "tags": ["food"]}], "Afternoon": [{"id": "0927C-P1", "title": "Mori Art Museum / stroll", "tags": ["art"]}], "Evening": [{"id": "0927C-E1", "title": "Andaz Tokyo Rooftop Bar", "tags": ["rooftop", "bar"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-09-28", "city": "Tokyo", "canon": "Updated: Sumo finals - requires advance tickets", "paths": [{"id": "A", "name": "Sumo Finals &amp; Ryogoku", "slots": {"Morning": [{"id": "0928A-M1", "title": "Explore Ryogoku district", "tags": ["culture"]}, {"id": "0928A-M2", "title": "Sumo Museum", "tags": ["museum", "sumo"]}], "Afternoon": [{"id": "0928A-P1", "title": "Attend Sumo Grand Tournament Finals", "tags": ["sumo", "event", "requires booking"]}], "Evening": [{"id": "0928A-E1", "title": "Chanko Nabe dinner (sumo stew)", "tags": ["food", "sumo"]}, {"id": "0928A-E2", "title": "Rooftop: The Roof @ Shibuya Stream", "tags": ["rooftop", "bar"]}]}}, {"id": "B", "name": "NPB baseball @ Meiji Jingu", "slots": {"Morning": [{"id": "0928B-M1", "title": "Café crawl (Omotesando)", "tags": ["coffee", "food"]}, {"id": "0928B-M2", "title": "Meiji Jingu Shrine walk", "tags": ["shrine", "calm"]}], "Afternoon": [{"id": "0928B-P1", "title": "Omotesando window-shopping", "tags": ["shopping"]}], "Evening": [{"id": "0928B-E1", "title": "Yakult Swallows game at Meiji Jingu Stadium", "tags": ["sports", "night"]}]}}, {"id": "C", "name": "teamLab + skyline", "slots": {"Morning": [{"id": "0928C-M1", "title": "Toyosu brunch", "tags": ["food"]}], "Afternoon": [{"id": "0928C-P1", "title": "teamLab Planets", "tags": ["art", "immersive"]}], "Evening": [{"id": "0928C-E1", "title": "Shibuya Sky or Andaz Rooftop", "tags": ["rooftop", "bar", "view"]}]}}, {"id": "D", "name": "Kabukiza single‑act + Ginza", "slots": {"Morning": [{"id": "0928D-M1", "title": "Ginza flagship stroll", "tags": ["shopping"]}], "Afternoon": [{"id": "0928D-P1", "title": "Queue for Kabukiza single‑act (makumi)", "tags": ["theatre", "culture"]}], "Evening": [{"id": "0928D-E1", "title": "Sushi or tempura dinner", "tags": ["food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-09-29", "city": "Tokyo", "paths": [{"id": "A", "name": "Kamakura day trip", "slots": {"Morning": [{"id": "0929A-M1", "title": "JR to Kamakura (~1h)", "tags": ["train", "daytrip"]}, {"id": "0929A-M2", "title": "Great Buddha (Kotoku‑in)", "tags": ["temple", "iconic"]}], "Afternoon": [{"id": "0929A-P1", "title": "Hase‑dera temple &amp; views", "tags": ["temple", "view"]}, {"id": "0929A-P2", "title": "Komachi‑dori snack crawl", "tags": ["streetfood"]}], "Evening": [{"id": "0929A-E1", "title": "Return to Tokyo; ramen run", "tags": ["food"]}]}}, {"id": "B", "name": "Pop culture + Planets", "slots": {"Morning": [{"id": "0929B-M1", "title": "Akihabara arcades &amp; retro", "tags": ["games", "pop"]}], "Afternoon": [{"id": "0929B-P1", "title": "teamLab Planets (if not yet)", "tags": ["immersive"]}], "Evening": [{"id": "0929B-E1", "title": "Wagyu yakiniku dinner", "tags": ["food"]}]}}, {"id": "C", "name": "Old Tokyo lanes", "slots": {"Morning": [{"id": "0929C-M1", "title": "Yanaka Ginza retro", "tags": ["street", "neighbourhood"]}], "Afternoon": [{"id": "0929C-P1", "title": "Kappabashi (kitchen street)", "tags": ["shopping"]}, {"id": "0929C-P2", "title": "Kuramae coffee", "tags": ["coffee"]}], "Evening": [{"id": "0929C-E1", "title": "Ginza cocktails", "tags": ["bar"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-09-30", "city": "Tokyo", "paths": [{"id": "A", "name": "Tsukiji + knives", "slots": {"Morning": [{"id": "0930A-M1", "title": "Tsukiji sushi breakfast", "tags": ["market", "food"]}], "Afternoon": [{"id": "0930A-P1", "title": "Knife demos/shopping", "tags": ["shopping", "craft"]}, {"id": "0930A-P2", "title": "Depachika safari", "tags": ["foodhall"]}], "Evening": [{"id": "0930A-E1", "title": "Rooftop: Andaz or Levita", "tags": ["rooftop", "bar"]}]}}, {"id": "B", "name": "Seasonal gardens", "slots": {"Morning": [{"id": "0930B-M1", "title": "Showa Kinen Park (cosmos)", "tags": ["garden", "flowers"]}], "Afternoon": [{"id": "0930B-P1", "title": "Rikugien or Koishikawa Korakuen", "tags": ["garden"]}], "Evening": [{"id": "0930B-E1", "title": "Golden Gai bar-hop", "tags": ["nightlife"]}]}}, {"id": "C", "name": "Architecture day", "slots": {"Morning": [{"id": "0930C-M1", "title": "Daikanyama &amp; Nakameguro", "tags": ["neighbourhood"]}], "Afternoon": [{"id": "0930C-P1", "title": "Omotesando architecture walk", "tags": ["design"]}], "Evening": [{"id": "0930C-E1", "title": "Omakase dinner (booked)", "tags": ["food", "omakase"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-01", "city": "Kyoto", "canon": "Canon transfer: Tokyo → Kyoto", "paths": [{"id": "A", "name": "Standard move", "slots": {"Morning": [{"id": "1001A-M1", "title": "Leisurely breakfast; last Tokyo errand", "tags": ["logistics"]}], "Afternoon": [{"id": "1001A-P1", "title": "Shinkansen (~2h20m)", "tags": ["train"]}, {"id": "1001A-P2", "title": "Check-in; Nishiki Market graze", "tags": ["market", "food"]}], "Evening": [{"id": "1001A-E1", "title": "Pontochō alley dinner", "tags": ["food", "alley"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-02", "city": "Kyoto", "paths": [{"id": "A", "name": "Arashiyama early", "slots": {"Morning": [{"id": "1002A-M1", "title": "Bamboo Grove at opening", "tags": ["scenic"]}, {"id": "1002A-M2", "title": "Tenryu-ji garden", "tags": ["temple", "garden"]}], "Afternoon": [{"id": "1002A-P1", "title": "Otagi Nenbutsu-ji", "tags": ["temple", "quirky"]}], "Evening": [{"id": "1002A-E1", "title": "Tea ceremony → Kaiseki dinner", "tags": ["tea", "kaiseki"]}]}}, {"id": "B", "name": "Fushimi + sake", "slots": {"Morning": [{"id": "1002B-M1", "title": "Fushimi Inari (early)", "tags": ["shrine", "hike"]}], "Afternoon": [{"id": "1002B-P1", "title": "Fushimi sake tastings", "tags": ["sake", "tasting"]}], "Evening": [{"id": "1002B-E1", "title": "Obanzai bistro", "tags": ["food"]}]}}, {"id": "C", "name": "Uji matcha day", "slots": {"Morning": [{"id": "1002C-M1", "title": "JR to Uji (20–30m)", "tags": ["train", "daytrip"]}, {"id": "1002C-M2", "title": "Byodoin Phoenix Hall", "tags": ["temple", "UNESCO"]}], "Afternoon": [{"id": "1002C-P1", "title": "Tea tasting; Uji River stroll", "tags": ["tea", "walk"]}], "Evening": [{"id": "1002C-E1", "title": "Back to Kyoto; Kiyamachi izakaya", "tags": ["izakaya"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-03", "city": "Kyoto", "canon": "Canon transfer: Kyoto → Osaka", "paths": [{"id": "A", "name": "Classic handoff", "slots": {"Morning": [{"id": "1003A-M1", "title": "Kiyomizu-dera + Higashiyama (early)", "tags": ["temple", "view"]}], "Afternoon": [{"id": "1003A-P1", "title": "Shinkansen to Osaka (13–15m)", "tags": ["train"]}, {"id": "1003A-P2", "title": "Namba check-in", "tags": ["logistics"]}], "Evening": [{"id": "1003A-E1", "title": "Dotonbori street-food crawl", "tags": ["streetfood"]}]}}, {"id": "B", "name": "Himeji today", "slots": {"Morning": [{"id": "1003B-M1", "title": "Shinkansen to Himeji; castle", "tags": ["castle", "UNESCO"]}], "Afternoon": [{"id": "1003B-P1", "title": "Koko-en garden", "tags": ["garden"]}, {"id": "1003B-P2", "title": "Continue to Osaka &amp; settle in", "tags": ["train", "logistics"]}], "Evening": [{"id": "1003B-E1", "title": "Neon Dotonbori", "tags": ["nightlife"]}]}}, {"id": "C", "name": "Slow morning", "slots": {"Morning": [{"id": "1003C-M1", "title": "Nijo Castle stroll", "tags": ["castle"]}], "Afternoon": [{"id": "1003C-P1", "title": "Train to Osaka; coffee + cake", "tags": ["train", "cafe"]}], "Evening": [{"id": "1003C-E1", "title": "Ura-Namba back-alley bars", "tags": ["izakaya", "bar"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-04", "city": "Osaka", "paths": [{"id": "A", "name": "Comfort-food loop", "slots": {"Morning": [{"id": "1004A-M1", "title": "Kuromon Market feast", "tags": ["market", "food"]}], "Afternoon": [{"id": "1004A-P1", "title": "Shinsekai + Tsutenkaku", "tags": ["retro", "view"]}, {"id": "1004A-P2", "title": "Kushikatsu (no double-dip!)", "tags": ["streetfood"]}], "Evening": [{"id": "1004A-E1", "title": "Dotonbori river cruise → Ura-Namba bars", "tags": ["nightlife"]}]}}, {"id": "B", "name": "Kobe day trip", "slots": {"Morning": [{"id": "1004B-M1", "title": "Nunobiki Ropeway &amp; Herb Gardens", "tags": ["view", "garden"]}], "Afternoon": [{"id": "1004B-P1", "title": "Kobe beef lunch", "tags": ["food"]}, {"id": "1004B-P2", "title": "Harborland stroll", "tags": ["harbour"]}], "Evening": [{"id": "1004B-E1", "title": "Back to Osaka; highballs", "tags": ["bar"]}]}}, {"id": "C", "name": "Himeji deep dive", "slots": {"Morning": [{"id": "1004C-M1", "title": "Himeji Castle + Koko-en", "tags": ["castle", "garden"]}], "Afternoon": [{"id": "1004C-P1", "title": "Late lunch &amp; ramble", "tags": ["food"]}], "Evening": [{"id": "1004C-E1", "title": "Okonomiyaki supper", "tags": ["food"]}]}}, {"id": "D", "name": "USJ Halloween", "slots": {"Morning": [{"id": "1004D-M1", "title": "Universal Studios Japan", "tags": ["themepark"]}], "Afternoon": [{"id": "1004D-P1", "title": "Halloween snacks + photos", "tags": ["food", "photo"]}], "Evening": [{"id": "1004D-E1", "title": "Feast back in Namba", "tags": ["food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-05", "city": "Osaka", "canon": "Canon transfer: Osaka → Tokyo", "paths": [{"id": "A", "name": "Standard move", "slots": {"Morning": [{"id": "1005A-M1", "title": "Easy start; station bento", "tags": ["food", "logistics"]}], "Afternoon": [{"id": "1005A-P1", "title": "Shinkansen back to Tokyo", "tags": ["train"]}, {"id": "1005A-P2", "title": "Check-in", "tags": ["logistics"]}], "Evening": [{"id": "1005A-E1", "title": "Kawagoe (‘Little Edo’) stroll (optional)", "tags": ["daytrip", "oldtown"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-06", "city": "Tokyo", "paths": [{"id": "A", "name": "Guided Fuji loop", "slots": {"Morning": [{"id": "1006A-M1", "title": "Coach to Fuji area", "tags": ["coach"]}], "Afternoon": [{"id": "1006A-P1", "title": "Lake Kawaguchi viewpoints", "tags": ["lake", "view"]}, {"id": "1006A-P2", "title": "Chureito Pagoda + ropeway", "tags": ["view"]}], "Evening": [{"id": "1006A-E1", "title": "Hōtō noodles", "tags": ["food"]}]}}, {"id": "B", "name": "DIY Kawaguchiko", "slots": {"Morning": [{"id": "1006B-M1", "title": "Highway bus from Shinjuku", "tags": ["bus"]}], "Afternoon": [{"id": "1006B-P1", "title": "Bike lakeshore; Oishi Park", "tags": ["bike", "park"]}, {"id": "1006B-P2", "title": "Ropeway if clear", "tags": ["view"]}], "Evening": [{"id": "1006B-E1", "title": "Return to Tokyo", "tags": ["bus"]}]}}, {"id": "C", "name": "Fuji‑Q Highland", "slots": {"Morning": [{"id": "1006C-M1", "title": "Rollercoasters + Fuji backdrops", "tags": ["themepark"]}], "Afternoon": [{"id": "1006C-P1", "title": "Snack through the park", "tags": ["food"]}], "Evening": [{"id": "1006C-E1", "title": "Back to Tokyo; ramen", "tags": ["food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-07", "city": "Tokyo", "paths": [{"id": "A", "name": "Hakone classic loop", "slots": {"Morning": [{"id": "1007A-M1", "title": "Romancecar to Hakone‑Yumoto", "tags": ["train"]}], "Afternoon": [{"id": "1007A-P1", "title": "Lake Ashi pirate ship", "tags": ["boat"]}, {"id": "1007A-P2", "title": "Ropeway to Ōwakudani (black eggs!)", "tags": ["geo"]}], "Evening": [{"id": "1007A-E1", "title": "Hakone Open‑Air Museum → back", "tags": ["art"]}]}}, {"id": "B", "name": "Onsen + shrine focus", "slots": {"Morning": [{"id": "1007B-M1", "title": "Onsen soak", "tags": ["onsen", "relax"]}], "Afternoon": [{"id": "1007B-P1", "title": "Hakone Shrine lakeside torii", "tags": ["shrine"]}], "Evening": [{"id": "1007B-E1", "title": "Café with Fuji peeks; return", "tags": ["cafe"]}]}}, {"id": "C", "name": "Outlets + views", "slots": {"Morning": [{"id": "1007C-M1", "title": "Ōwakudani ropeway", "tags": ["geo"]}], "Afternoon": [{"id": "1007C-P1", "title": "Gotemba Premium Outlets", "tags": ["shopping"]}], "Evening": [{"id": "1007C-E1", "title": "Back to Tokyo dinner", "tags": ["food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-08", "city": "Tokyo", "paths": [{"id": "A", "name": "Pop + teamLab", "slots": {"Morning": [{"id": "1008A-M1", "title": "Akihabara wander", "tags": ["pop"]}], "Afternoon": [{"id": "1008A-P1", "title": "teamLab (Borderless or Planets)", "tags": ["immersive"]}], "Evening": [{"id": "1008A-E1", "title": "Rooftop crawl: Shibuya Sky → Andaz", "tags": ["rooftop"]}]}}, {"id": "B", "name": "Gourmet Tokyo", "slots": {"Morning": [{"id": "1008B-M1", "title": "Toyosu observation decks + sushi", "tags": ["market", "food"]}], "Afternoon": [{"id": "1008B-P1", "title": "Knife/depachika gifts", "tags": ["shopping", "foodhall"]}], "Evening": [{"id": "1008B-E1", "title": "High‑end omakase", "tags": ["food", "omakase"]}]}}, {"id": "C", "name": "Gardens + lanes", "slots": {"Morning": [{"id": "1008C-M1", "title": "Daikanyama → Nakameguro", "tags": ["neighbourhood"]}], "Afternoon": [{"id": "1008C-P1", "title": "Hamarikyu or Shinjuku Gyoen", "tags": ["garden"]}], "Evening": [{"id": "1008C-E1", "title": "Omoide Yokocho → Golden Gai", "tags": ["nightlife"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-09", "city": "Tokyo", "canon": "Canon transfer: early flight to HKG", "paths": [{"id": "A", "name": "HK welcome", "slots": {"Morning": [{"id": "1009A-M1", "title": "Fly to HKG; Airport Express", "tags": ["plane", "train"]}], "Afternoon": [{"id": "1009A-P1", "title": "Peak Tram → Victoria Peak", "tags": ["view"]}, {"id": "1009A-P2", "title": "Mid‑Levels Escalators; Graham St art; Man Mo Temple", "tags": ["walk", "temple"]}], "Evening": [{"id": "1009A-E1", "title": "Symphony of Lights; cha chaan teng", "tags": ["harbour", "food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-10", "city": "Hong Kong", "paths": [{"id": "A", "name": "Lantau big views", "slots": {"Morning": [{"id": "1010A-M1", "title": "Ngong Ping 360 cable car", "tags": ["cablecar"]}], "Afternoon": [{"id": "1010A-P1", "title": "Big Buddha + Po Lin Monastery", "tags": ["temple"]}, {"id": "1010A-P2", "title": "Tai O stilt village seafood", "tags": ["food", "village"]}], "Evening": [{"id": "1010A-E1", "title": "Temple St Night Market → Tim Ho Wan", "tags": ["market", "dim sum"]}]}}, {"id": "B", "name": "Kowloon culture loop", "slots": {"Morning": [{"id": "1010B-M1", "title": "Wong Tai Sin Temple", "tags": ["temple"]}], "Afternoon": [{"id": "1010B-P1", "title": "Nan Lian Garden; museum option", "tags": ["garden", "museum"]}], "Evening": [{"id": "1010B-E1", "title": "Rooftop: Skye or Sugar", "tags": ["rooftop", "bar"]}]}}, {"id": "C", "name": "Island chill", "slots": {"Morning": [{"id": "1010C-M1", "title": "Ferry to Lamma Island", "tags": ["ferry"]}], "Afternoon": [{"id": "1010C-P1", "title": "Easy trail + beach/seafood", "tags": ["walk", "food"]}], "Evening": [{"id": "1010C-E1", "title": "Mak’s wonton + Tai Cheong egg tarts", "tags": ["food"]}]}}]},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{"date": "2025-10-11", "city": "Hong Kong", "canon": "Canon: late-night departure", "paths": [{"id": "A", "name": "Central wind‑down", "slots": {"Morning": [{"id": "1011A-M1", "title": "SoHo street art; PMQ design", "tags": ["art", "shopping"]}], "Afternoon": [{"id": "1011A-P1", "title": "Causeway Bay shopping", "tags": ["shopping"]}], "Evening": [{"id": "1011A-E1", "title": "Popinjays or OZONE → Airport Express", "tags": ["rooftop", "bar"]}]}}, {"id": "B", "name": "Kowloon flavors", "slots": {"Morning": [{"id": "1011B-M1", "title": "Mong Kok markets", "tags": ["market"]}], "Afternoon": [{"id": "1011B-P1", "title": "TST promenade / museums", "tags": ["harbour", "museum"]}], "Evening": [{"id": "1011B-E1", "title": "Sugar or Skye; airport run", "tags": ["rooftop"]}]}}, {"id": "C", "name": "Dim sum + spa", "slots": {"Morning": [{"id": "1011C-M1", "title": "Dim sum brunch", "tags": ["food", "dim sum"]}], "Afternoon": [{"id": "1011C-P1", "title": "Spa &amp; coffee crawl", "tags": ["relax", "cafe"]}], "Evening": [{"id": "1011C-E1", "title": "Harbour cruise + egg tarts → airport", "tags": ["harbour", "food"]}]}}]}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>citySections: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"Tokyo": {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>intro: `Tokyo, a city of exhilarating contrasts, serves as a captivating introduction to Japan. This initial segment of the journey is designed for a dynamic exploration, balancing iconic modern landmarks with unique cultural experiences. The timing of the visit in late September offers a unique advantage, as it directly overlaps with the tail end of the Tokyo Festival and potentially other local events like the Nezu-jinja Shrine Festival and the Chofu Autumn Fireworks. This presents immediate opportunities for cultural immersion and distinctive experiences right from arrival, although it also necessitates checking specific event dates and being prepared for larger gatherings.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>culinary: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Tokyo's culinary scene is characterized by innovation and modern trends. Beyond traditional dishes, the focus is on cutting-edge or specialized culinary arts.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Sushi &amp; Seafood:&lt;/strong&gt; Experience unparalleled freshness at Tsukiji Outer Market or Toyosu Wholesale Fish Market. For a curated, high-end sushi journey, an Omakase experience is highly recommended.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Ramen:&lt;/strong&gt; Explore the diverse regional ramen styles that converge in Tokyo, perhaps at Tokyo Station's renowned Ramen Street.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Wagyu:&lt;/strong&gt; Indulge in premium Wagyu beef, either through a dedicated Wagyu tasting tour or a Wagyu Yakiniku dinner, offering a focused and elevated dining experience.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Traditional Sweets (Wagashi):&lt;/strong&gt; Discover the delicate artistry of Wagashi by participating in a hands-on class, learning to craft these beautiful confections.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Depachika:&lt;/strong&gt; Explore gourmet food halls located in department store basements, which offer an incredible array of Japanese and international delicacies, perfect for high-end culinary souvenirs or diverse meal assembly.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Izakaya Culture:&lt;/strong&gt; Experience the lively atmosphere of casual Japanese pubs, where locals gather to enjoy drinks and small plates.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Rooftop Bars:&lt;/strong&gt; Enjoy panoramic city views with a drink at stylish rooftop bars like Shibuya Sky (observation deck with bar), The Roof at Shibuya Stream, or the Garden Lounge at Cerulean Tower Tokyu Hotel.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cultural: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Tokyo offers a rich tapestry of cultural experiences, from ancient traditions to modern pop culture.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Hands-On Experiences:&lt;/strong&gt; Sushi Making Class, Wagashi Confection Making, Taiko Drumming Experience, Japanese Tea Ceremony, Samurai Experience, Furin Crafting, Origami Masterclass, Calligraphy Classes.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Festivals &amp; Events:&lt;/strong&gt; Tokyo Festival (Ikebukuro), Nezu-jinja Shrine Annual Grand Festival, Fukuro Matsuri (Ikebeburo), Shinagawa Shukuba-matsuri Festival, Chofu Autumn Fireworks.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Exploring Local Neighborhoods:&lt;/strong&gt; Monzen Nakacho &amp; Fukagawa, Yanaka Ginza &amp; Togoshi Ginza.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"Kyoto": {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>intro: `Kyoto, the ancient capital, is a city steeped in history, renowned for its serene temples, traditional gardens, and refined culinary traditions. This two-day immersion will guide travelers through Japan's spiritual and aesthetic heart. While Kyoto is celebrated for its tranquil temples, its popularity means that many prominent sites like Kinkakuji, Ginkaku-ji, and Kiyomizudera are predictably crowded. Therefore, a key strategy involves visiting popular sites during early morning or late afternoon hours to mitigate crowds, and interspersing these with visits to less-frequented temples or off-the-beaten-path locations to achieve a balanced and more contemplative experience.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>culinary: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Kyoto's food culture is distinctively refined, emphasizing elegant dishes rooted in centuries-old historical traditions.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Kaiseki Ryori:&lt;/strong&gt; This multi-course meal represents the pinnacle of Kyoto's dining, featuring masterfully prepared seasonal ingredients that are as visually stunning as they are delicious.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Shojin Ryori:&lt;/strong&gt; Experience traditional vegetarian Buddhist monk's cuisine, often enjoyed in the serene settings of temples, emphasizing simple yet profound flavors.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Obanzai Ryori:&lt;/strong&gt; Savor Kyoto's traditional home-style cooking, characterized by multiple small, comforting dishes.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Nishiki Market:&lt;/strong&gt; Known as "Kyoto's Kitchen," this vibrant market offers a vast array of local produce, regional specialties, and street food, perfect for a culinary exploration.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Sake Tasting:&lt;/strong&gt; Explore the Fushimi Sake District, an area celebrated for its breweries and offering diverse sake tasting experiences.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cultural: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Kyoto offers a deep dive into traditional Japanese arts, crafts, and spiritual practices.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Hands-On Experiences:&lt;/strong&gt; Japanese Tea Ceremony, Soba Noodle Masterclass.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Festivals &amp; Events:&lt;/strong&gt; Jidai Matsuri (Historical parade), Kurama Fire Festival (Traditional fire festival), Otsukimi (Moon Viewing Festivals).`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Traditional Arts &amp; Crafts:&lt;/strong&gt; Seek out shops specializing in pottery, textiles, and woodblock prints.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"Osaka": {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>intro: `Osaka, often hailed as the "Kitchen of Japan," offers a vibrant, laid-back atmosphere and a distinct comfort food culture. This two-day segment of the journey will be a feast for the senses, focusing on street food, quirky neighborhoods, and unique dining experiences. Osaka's culinary scene is explicitly characterized by its "comfort food" and "laid-back atmosphere." This implies a distinct dining philosophy compared to Tokyo's innovation or Kyoto's refinement, encouraging a more casual and spontaneous approach to eating. Furthermore, beyond just Dotonbori, Osaka boasts several distinct "quirky neighborhoods," each with its own unique character and culinary focus, suggesting that a deeper exploration of Osaka involves thematic neighborhood visits rather than merely central landmarks.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>culinary: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Osaka's culinary scene is explicitly characterized by "comfort food" and a "laid-back atmosphere," encouraging a more casual and spontaneous approach to eating.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Takoyaki:&lt;/strong&gt; These fried octopus balls are a ubiquitous and beloved street snack, representing the heart of Osaka's casual dining.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Okonomiyaki:&lt;/strong&gt; Enjoy these savory pancakes, a highly customizable and hearty dish that embodies Osaka's approachable food culture.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Kushikatsu:&lt;/strong&gt; Deep-fried skewers of various ingredients offer a popular and versatile comfort food experience.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Kuromon Market:&lt;/strong&gt; Referred to as "Osaka's Kitchen," this vibrant market is a prime destination for fresh seafood and local delicacies, including Fugu sashimi.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Unique Dining:&lt;/strong&gt; For an interactive and memorable experience, consider catching and eating your own fish at Tsurikichi.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cultural: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Osaka offers a unique blend of retro charm, modern entertainment, and vibrant local life.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Hands-On Experiences:&lt;/strong&gt; Osaka Cooking Class (Takoyaki/Okonomiyaki).`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Festivals &amp; Events:&lt;/strong&gt; Kishiwada Danjiri Matsuri, USJ Halloween.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Exploring Local Neighborhoods:&lt;/strong&gt; Shinsekai District, Nakazakicho, Ura Namba.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>"Hong Kong": {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>intro: `Hong Kong, a vibrant fusion of East and West, offers a dynamic urban landscape, spiritual sanctuaries, and a world-renowned culinary scene. This short yet intense visit is designed to focus on its iconic sights and unforgettable flavors. Hong Kong's culinary identity is a dynamic blend of Cantonese, European (especially British), and other Asian influences. This unique fusion promises a broad and diverse gastronomic adventure, where the foodie experience extends beyond specific traditional dishes to encompass a distinctive East-meets-West gastronomic identity. Given the limited time (2.5 days) and the preference for no day trips outside the city, the itinerary strategically groups attractions geographically and thematically to minimize transit time and maximize exploration within Hong Kong's distinct areas.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>culinary: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Hong Kong cuisine is a dynamic blend of Cantonese, European (especially British), and other Asian influences, offering a broad and diverse culinary adventure.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Dim Sum:&lt;/strong&gt; A quintessential Hong Kong experience, best enjoyed at Michelin-starred establishments like Tim Ho Wan, famous for its Baked BBQ Pork Buns and other classic dishes.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Hong Kong-style Milk Tea &amp; Egg Tarts:&lt;/strong&gt; These iconic local beverages and pastries reflect the city's unique colonial history and fusion culture.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Wonton Noodles:&lt;/strong&gt; A classic Cantonese dish, perfected in Hong Kong and a staple of local cuisine.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Roasted Goose/Duck:&lt;/strong&gt; A Cantonese specialty, often found in traditional restaurants and highly prized.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Street Food:&lt;/strong&gt; Explore bustling night markets for a wide array of local snacks, offering a vibrant and authentic dining experience.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Rooftop Bars:&lt;/strong&gt; Experience stunning skyline views from high-altitude bars like Ozone (Ritz-Carlton), Aqua (Tsim Sha Tsui), or Sevva (Central).`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cultural: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>intro: `Hong Kong offers a unique blend of spiritual sites, bustling markets, and modern urban experiences.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>highlights: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Hands-On Experiences:&lt;/strong&gt; While less focused on traditional classes, the city offers unique culinary tours and market explorations.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Festivals &amp; Events:&lt;/strong&gt; Check for local festivals or events happening during your stay.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>`&lt;strong&gt;Exploring Local Neighborhoods:&lt;/strong&gt; Tai O Fishing Village, Mong Kok, Graham Street.`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>practicalConsiderations: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>id: "practical-considerations",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>title: "Practical Considerations &amp; Insider Tips for a Smooth Journey",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>intro: `Ensuring a seamless and enjoyable trip requires foresight and attention to detail, particularly given the popularity of the chosen destinations and the travel period. The combination of major tourist hubs (Tokyo, Kyoto, Osaka, Hong Kong) and the timing (late September/early October, coinciding with Japanese public holidays and festivals) creates a high likelihood of significant crowds. This is not merely a minor inconvenience but a critical factor that can impact the quality of the experience, necessitating proactive planning and strategic navigation to maximize enjoyment and minimize potential frustrations.`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sections: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Strategic Timing for Attractions", content: `Arriving early morning or late afternoon at popular sites (Arashiyama Bamboo Grove, Fushimi Inari Taisha, Kinkakuji, Shibuya Sky) can significantly reduce crowds. Whenever feasible, visit major attractions on weekdays to avoid larger weekend crowds, especially during national public holidays.`, details: `` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Booking Essentials", content: `Tickets for Ghibli Museum and Mario Kart Racing are highly sought after and must be booked well in advance. Reservations for high-end Omakase experiences or unique restaurants are highly recommended for groups. Booking Shinkansen tickets in advance is advisable, especially during holiday periods. Secure hotel bookings well in advance. **For the Sumo Grand Tournament Finals, tickets are extremely competitive and often sell out immediately upon release; securing them well in advance is critical.**`, details: `` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Navigating Crowds", content: `Be prepared to adjust plans if a site is unexpectedly crowded. Utilize early mornings or late afternoons. Incorporate "off the beaten path" locations (Otagi Nenbutsu-ji in Kyoto, Nakazakicho in Osaka) to escape main tourist flows.`, details: `` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Language &amp; Communication", content: `Modern translation applications (e.g., Google Translate) are invaluable. Learning simple Japanese phrases (arigato, sumimasen, konnichiwa) and Cantonese phrases (jo san, m goi) can greatly enhance interactions.`, details: `` },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{ heading: "Safety &amp; Local Customs", content: `Adhere to public transport etiquette (quiet carriages, no loud phone conversations, respect queues). Be aware of dining customs (no double-dipping for kushikatsu). Tipping is generally not customary in Japan or Hong Kong. Be prepared for extensive walking. Carry sufficient local currency (Japanese Yen and Hong Kong Dollars).`, details: `` }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const allActivities = itineraryData.itineraryDays.flatMap(d =&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>d.paths.flatMap(p =&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>Object.entries(p.slots).flatMap(([slot, items]) =&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>items.map(i =&gt; ({...i, date: d.date, city: d.city, path: p.id, slot}))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>)</span></p>
<p class="p1"><span class="s1">);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">let progress = {}</span></p>
<p class="p1"><span class="s1">let selectedTabs = {}</span></p>
<p class="p1"><span class="s1">let filters = { city: "All", tag: "All", status: "All", search: "" };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function saveProgress() { localStorage.setItem(STORAGE_KEY, JSON.stringify(progress)); }</span></p>
<p class="p1"><span class="s1">function loadProgress() { try { progress = JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); } catch(e) { progress = {}; } }</span></p>
<p class="p1"><span class="s1">loadProgress();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function fmtDate(iso) { return new Date(iso + "T00:00:00").toLocaleDateString(undefined, {weekday:"short", day:"2-digit", month:"short"}); }</span></p>
<p class="p1"><span class="s1">function pct(a,b) { if(!b) return 0; return Math.round((a/b)*100); }</span></p>
<p class="p1"><span class="s1">function el(html) { const d=document.createElement("div"); d.innerHTML = html.trim(); return d.firstChild; }</span></p>
<p class="p1"><span class="s1">function getCities() { return ["All", ...Array.from(new Set(itineraryData.itineraryDays.map(d =&gt; d.city)))]; }</span></p>
<p class="p1"><span class="s1">function getTags() { const s=new Set(); allActivities.forEach(a =&gt; (a.tags||[]).forEach(t=&gt;s.add(t))); return ["All", ...Array.from(s).sort()]; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function applyFilters(a) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (filters.city !== "All" &amp;&amp; a.city !== filters.city) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (filters.tag !== "All" &amp;&amp; !(a.tags||[]).includes(filters.tag)) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const q = filters.search.trim().toLowerCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (q &amp;&amp; !(a.title + " " + a.city + " " + a.slot).toLowerCase().includes(q)) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (filters.status === "Done" &amp;&amp; !progress[a.id]) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if (filters.status === "Todo" &amp;&amp; progress[a.id]) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return true;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function totals() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const per = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>allActivities.forEach(a=&gt;{ const k=a.city; per[k]=per[k]||{done:0,total:0}; per[k].total++; if(progress[a.id]) per[k].done++; });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const overallDone = Object.values(per).reduce((s,c)=&gt;s+c.done,0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const overallTotal = Object.values(per).reduce((s,c)=&gt;s+c.total,0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>return {per, overallDone, overallTotal};</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function renderSummary() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const wrap = document.getElementById("progressSummary");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>wrap.innerHTML = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const t = totals();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>Object.entries(t.per).forEach(([city,v]) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>wrap.appendChild(el(`&lt;div&gt;&lt;div class="flex justify-between text-sm mb-1"&gt;&lt;span&gt;${city}&lt;/span&gt;&lt;span&gt;${v.done}/${v.total}&lt;/span&gt;&lt;/div&gt;&lt;div class="progress"&gt;&lt;span style="width:${pct(v.done,v.total)}%"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>wrap.appendChild(el(`&lt;div class="pt-2"&gt;&lt;div class="flex justify-between text-sm mb-1 font-medium"&gt;&lt;span&gt;Overall&lt;/span&gt;&lt;span&gt;${t.overallDone}/${t.overallTotal}&lt;/span&gt;&lt;/div&gt;&lt;div class="progress"&gt;&lt;span style="width:${pct(t.overallDone,t.overallTotal)}%"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;`));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function nextUp() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const cand = allActivities.filter(a =&gt; !progress[a.id]).filter(applyFilters).sort((x,y)=&gt;new Date(x.date)-new Date(y.date))[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>const wrap = document.getElementById("nextUpWrap");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>if(!cand) { wrap.innerHTML = ""; return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>wrap.innerHTML = `&lt;div class="rounded-2xl border p-3 mb-3 card"&gt;&lt;div class="flex items-center gap-3"&gt;&lt;div class="text-emerald-600"&gt;🧭&lt;/div&gt;&lt;div class="text-sm"&gt;&lt;div class="font-medium"&gt;Next up&lt;/div&gt;&lt;div class="text-slate-600 dark:text-slate-400"&gt;${fmtDate(cand.date)} · ${cand.city} · Path ${cand.path}: &lt;span class="font-medium"&gt;${cand.title}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="ml-auto"&gt;&lt;button class="btn btn-primary" onclick="toggle('${cand.id}')"&gt;✔️ Mark done&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function toggle(id) { progress[id] = !progress[id]; saveProgress(); renderAll(); }</span></p>
<p class="p1"><span class="s1">function markPath(date, pathId, val) { allActivities.filter(a=&gt;a.date===date&amp;&amp;a.path===pathId).forEach(a=&gt;progress[a.id]=val); saveProgress(); renderAll(); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function createSectionDetails(section) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;details class="mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;summary&gt;${section.heading}&lt;/summary&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="p-2 text-sm text-stone-600 dark:text-stone-400"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p&gt;${section.content}&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>${section.details || ''}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/details&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>`;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function renderContent() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const contentWrap = document.getElementById("itineraryContent");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>contentWrap.innerHTML = "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Pre-Trip Essentials</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>contentWrap.appendChild(el(`&lt;h2 id="${itineraryData.preTripEssentials.id}" class="section-heading"&gt;&lt;span&gt;${itineraryData.preTripEssentials.title}&lt;/span&gt;&lt;/h2&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const preTripCard = el(`&lt;div class="card p-6 mb-8"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>itineraryData.preTripEssentials.sections.forEach(s =&gt; preTripCard.appendChild(el(createSectionDetails(s))));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>contentWrap.appendChild(preTripCard);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let currentCity = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>itineraryData.itineraryDays.forEach(day =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (day.city !== currentCity &amp;&amp; !day.canon) { // Start of a new city section, and not just a travel day</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>currentCity = day.city;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const cityInfo = itineraryData.citySections[day.city];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (cityInfo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>contentWrap.appendChild(el(`&lt;h2 id="${day.city.toLowerCase().replace(/\s/g, '-')}-section" class="section-heading"&gt;&lt;span&gt;${day.city}: ${day.date} - ${itineraryData.itineraryDays.findLast(d =&gt; d.city === day.city &amp;&amp; !d.canon)?.date || day.date}&lt;/span&gt;&lt;/h2&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const cityIntroCard = el(`&lt;div class="card p-6 mb-8"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>cityIntroCard.appendChild(el(`&lt;p class="mb-6 text-stone-600 dark:text-stone-400"&gt;${cityInfo.intro}&lt;/p&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>cityIntroCard.appendChild(el(`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;details class="mb-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;summary class="text-xl"&gt;Culinary Deep Dive&lt;/summary&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="p-2 text-sm text-stone-600 dark:text-stone-400"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="mb-2"&gt;${cityInfo.culinary.intro}&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ul class="list-disc list-inside ml-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>${cityInfo.culinary.highlights.map(h =&gt; `&lt;li&gt;${h}&lt;/li&gt;`).join('')}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/details&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>cityIntroCard.appendChild(el(`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;details class="mb-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;summary class="text-xl"&gt;Cultural Immersion&lt;/summary&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="p-2 text-sm text-stone-600 dark:text-stone-400"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="mb-2"&gt;${cityInfo.cultural.intro}&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ul class="list-disc list-inside ml-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>${cityInfo.cultural.highlights.map(h =&gt; `&lt;li&gt;${h}&lt;/li&gt;`).join('')}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/details&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>contentWrap.appendChild(cityIntroCard);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const card = el(`&lt;div class="card p-4 mb-4"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const header = el(`&lt;div class="pb-2 flex items-center gap-2 flex-wrap"&gt;&lt;div class="font-semibold text-lg"&gt;📅 ${fmtDate(day.date)}&lt;/div&gt;&lt;div class="text-slate-500"&gt;📍 ${day.city}&lt;/div&gt;${day.canon?`&lt;span class='badge badge-black'&gt;${day.canon}&lt;/span&gt;`:''}&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>card.appendChild(header);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (!day.canon) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if(!selectedTabs[day.date]) selectedTabs[day.date] = (day.paths[0]||{}).id || "A";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const tabs = el(`&lt;div class="grid grid-cols-4 gap-2 mb-3"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>day.paths.forEach(p=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const b=el(`&lt;button class="tab-btn"&gt;${p.name.split(' ')[0]}&lt;/button&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if(selectedTabs[day.date]===p.id) b.classList.add("active");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>b.onclick=()=&gt;{selectedTabs[day.date]=p.id; renderAll();};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>tabs.appendChild(b);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>card.appendChild(tabs);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>day.paths.forEach(p=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const vis = selectedTabs[day.date]===p.id || day.canon; // Always show content for canon events</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const items = Object.values(p.slots).flat();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const done = items.filter(i=&gt;progress[i.id]).length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const total = items.length || 1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const sec = el(`&lt;div class="path-section ${vis?'':'hidden'}"&gt;&lt;/div&gt;`);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!day.canon) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>sec.appendChild(el(`&lt;div class="flex items-center gap-2 mb-2"&gt;&lt;div class="text-base font-medium"&gt;${p.name}&lt;/div&gt;&lt;div class="ml-auto text-xs text-slate-500 dark:text-slate-400"&gt;${done}/${total}&lt;/div&gt;&lt;/div&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>sec.appendChild(el(`&lt;div class="progress mb-3"&gt;&lt;span style="width:${pct(done,total)}%"&gt;&lt;/span&gt;&lt;/div&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const grid = el(`&lt;div class="grid grid-cols-1 md:grid-cols-3 gap-3"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>Object.entries(p.slots).forEach(([slot,acts])=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const col=el(`&lt;div class="rounded-xl border p-3 bg-stone-50 dark:bg-slate-800 border-stone-200 dark:border-slate-700"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>col.appendChild(el(`&lt;div class="font-medium mb-2 text-stone-700 dark:text-stone-200"&gt;⏰ ${slot}&lt;/div&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const list=el(`&lt;div class="space-y-2"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>acts.forEach(a=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>if(!applyFilters(a)) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const checked = !!progress[a.id];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const row = el(`&lt;label class="flex items-start gap-2 text-sm cursor-pointer"&gt;&lt;/label&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const cb = el(`&lt;input type="checkbox" ${checked?'checked':''}&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>cb.onchange = () =&gt; toggle(a.id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const title = el(`&lt;div class="${checked?'strike':''}"&gt;${a.title}&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const tags = el(`&lt;div class="mt-1"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>(a.tags||[]).forEach(t=&gt;tags.appendChild(el(`&lt;span class="pill mr-1 mb-1 inline-block"&gt;${t}&lt;/span&gt;`)));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>const wrapInner = el(`&lt;div&gt;&lt;/div&gt;`); wrapInner.appendChild(title); wrapInner.appendChild(tags);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>row.appendChild(cb); row.appendChild(wrapInner); list.appendChild(row);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>col.appendChild(list); grid.appendChild(col);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>sec.appendChild(grid);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!day.canon) { // Only show path actions for non-canon days</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const actions = el(`&lt;div class="flex items-center gap-2 mt-3"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const b1 = el(`&lt;button class="btn btn-primary"&gt;✔️ Mark all in Path ${p.id} done&lt;/button&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>b1.onclick = () =&gt; markPath(day.date, p.id, true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const b2 = el(`&lt;button class="btn"&gt;↺ Reset this Path&lt;/button&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>b2.onclick = () =&gt; markPath(day.date, p.id, false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>actions.appendChild(b1); actions.appendChild(b2); sec.appendChild(actions);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>card.appendChild(sec);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>contentWrap.appendChild(card);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Practical Considerations</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>contentWrap.appendChild(el(`&lt;h2 id="${itineraryData.practicalConsiderations.id}" class="section-heading"&gt;&lt;span&gt;${itineraryData.practicalConsiderations.title}&lt;/span&gt;&lt;/h2&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const practicalCard = el(`&lt;div class="card p-6 mt-8"&gt;&lt;/div&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>practicalCard.appendChild(el(`&lt;p class="mb-4 text-stone-600 dark:text-stone-400"&gt;${itineraryData.practicalConsiderations.intro}&lt;/p&gt;`));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>itineraryData.practicalConsiderations.sections.forEach(s =&gt; practicalCard.appendChild(el(createSectionDetails(s))));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>contentWrap.appendChild(practicalCard);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function renderAll() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>renderSummary();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>nextUp();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>renderContent(); // Re-render content to apply filters and path selections</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>populateSidebar(); // Re-populate sidebar to ensure correct links and active state</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>setupDetailsToggle(); // Re-attach listener for details transition</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Custom Modal Logic</span></p>
<p class="p1"><span class="s1">const customModal = document.getElementById('customModal');</span></p>
<p class="p1"><span class="s1">const modalTitle = document.getElementById('modalTitle');</span></p>
<p class="p1"><span class="s1">const modalMessage = document.getElementById('modalMessage');</span></p>
<p class="p1"><span class="s1">const modalCancel = document.getElementById('modalCancel');</span></p>
<p class="p1"><span class="s1">const modalConfirm = document.getElementById('modalConfirm');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function showModal(title, message, isConfirm = false) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return new Promise((resolve) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalTitle.textContent = title;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalMessage.innerHTML = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalCancel.style.display = isConfirm ? 'block' : 'none'; // Show cancel only for confirm</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalConfirm.textContent = isConfirm ? 'Confirm' : 'OK';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>customModal.classList.add('open');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const confirmHandler = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>customModal.classList.remove('open');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>modalConfirm.removeEventListener('click', confirmHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>modalCancel.removeEventListener('click', cancelHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>resolve(true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const cancelHandler = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>customModal.classList.remove('open');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>modalConfirm.removeEventListener('click', confirmHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>modalCancel.removeEventListener('click', cancelHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>resolve(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalConfirm.addEventListener('click', confirmHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>modalCancel.addEventListener('click', cancelHandler);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Smooth transition for details tags</span></p>
<p class="p1"><span class="s1">function setupDetailsToggle() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>document.querySelectorAll('details').forEach((details) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>details.addEventListener('toggle', (event) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>const content = details.querySelector('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>if (details.open) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>content.style.maxHeight = content.scrollHeight + 'px';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>content.style.maxHeight = '0';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Sidebar population and scrolling</span></p>
<p class="p1"><span class="s1">function populateSidebar() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sidebarNav = document.getElementById('sidebarNav');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sidebarNav.innerHTML = `&lt;h3 class="font-bold text-stone-800 dark:text-stone-100 text-lg mb-2"&gt;Sections&lt;/h3&gt;`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const sections = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{ id: itineraryData.preTripEssentials.id, title: "Pre-Trip Essentials" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let lastCity = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>itineraryData.itineraryDays.forEach(day =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (day.city !== lastCity &amp;&amp; !day.canon) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const citySectionId = `${day.city.toLowerCase().replace(/\s/g, '-')}-section`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const lastDayForCity = itineraryData.itineraryDays.findLast(d =&gt; d.city === day.city &amp;&amp; !d.canon);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const title = `${day.city} (${fmtDate(day.date)} - ${fmtDate(lastDayForCity.date)})`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>sections.push({ id: citySectionId, title: title });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>lastCity = day.city;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sections.push({ id: itineraryData.practicalConsiderations.id, title: "Practical Considerations" });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>sections.forEach(sec =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const link = el(`&lt;a href="#${sec.id}"&gt;${sec.title}&lt;/a&gt;`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>link.onclick = (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(sec.id).scrollIntoView({ behavior: 'smooth' });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>// Optional: Add active class to sidebar link</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>sidebarNav.querySelectorAll('a').forEach(a =&gt; a.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>link.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>sidebarNav.appendChild(link);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// Add scroll listener for active sidebar link</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const observerOptions = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>root: null,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>rootMargin: '0px',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>threshold: 0.5 // Adjust as needed</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const observer = new IntersectionObserver((entries) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>entries.forEach(entry =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (entry.isIntersecting) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>sidebarNav.querySelectorAll('a').forEach(a =&gt; a.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>const activeLink = sidebarNav.querySelector(`a[href="#${entry.target.id}"]`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>if (activeLink) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>activeLink.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">          </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}, observerOptions);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('.section-heading').forEach(section =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">      </span>observer.observe(section);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Controls</span></p>
<p class="p1"><span class="s1">document.getElementById("printBtn").onclick = () =&gt; window.print();</span></p>
<p class="p1"><span class="s1">document.getElementById("exportBtn").onclick = () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const blob=new Blob([JSON.stringify(progress,null,2)],{type:"application/json"});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const url=URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const a=document.createElement("a");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.href=url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.download="itinerary-progress.json";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.click();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>URL.revokeObjectURL(url);</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p1"><span class="s1">document.getElementById("importInput").onchange = async (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const f=e.target.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(!f) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const r=new FileReader();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>r.onload= async ()=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>try{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>progress=JSON.parse(r.result);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>saveProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>await showModal('Import Successful', 'Your progress has been imported successfully.', false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>renderAll();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}catch{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>await showModal('Import Failed', 'Invalid JSON file. Please ensure the file contains valid progress data.', false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>r.readAsText(f);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>e.target.value = ''; // Clear file input</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p1"><span class="s1">document.getElementById("resetBtn").onclick = async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const confirmed = await showModal('Reset Progress', 'Are you sure you want to reset all your progress? This action cannot be undone.', true);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if(confirmed) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>progress={};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>saveProgress();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>renderAll();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Dark toggle</span></p>
<p class="p1"><span class="s1">const darkToggle = document.getElementById("darkToggle");</span></p>
<p class="p1"><span class="s1">const savedDark = localStorage.getItem("itinerary-dark") === "true";</span></p>
<p class="p1"><span class="s1">if(savedDark) document.documentElement.classList.add("dark");</span></p>
<p class="p1"><span class="s1">darkToggle.checked = savedDark;</span></p>
<p class="p1"><span class="s1">darkToggle.onchange = () =&gt; { document.documentElement.classList.toggle("dark", darkToggle.checked); localStorage.setItem("itinerary-dark", darkToggle.checked ? "true" : "false"); };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Populate filters</span></p>
<p class="p1"><span class="s1">const citySel = document.getElementById("cityFilter");</span></p>
<p class="p1"><span class="s1">getCities().forEach(c =&gt; citySel.appendChild(el(`&lt;option&gt;${c}&lt;/option&gt;`)));</span></p>
<p class="p1"><span class="s1">citySel.onchange = () =&gt; { filters.city = citySel.value; renderAll(); };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const tagSel = document.getElementById("tagFilter");</span></p>
<p class="p1"><span class="s1">getTags().forEach(t =&gt; tagSel.appendChild(el(`&lt;option&gt;${t}&lt;/option&gt;`)));</span></p>
<p class="p1"><span class="s1">tagSel.onchange = () =&gt; { filters.tag = t.value; renderAll(); };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">document.getElementById("statusFilter").onchange = (e) =&gt; { filters.status = e.target.value; renderAll(); };</span></p>
<p class="p1"><span class="s1">document.getElementById("searchInput").oninput = (e) =&gt; { filters.search = e.target.value; renderAll(); };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">renderAll();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
